import React, {useRef, useState} from 'react';
import axios from "axios";
import icon1 from '../../../assets/img/icon1.png'
import load from '../../../assets/img/load.gif'

const OsintInput = () => {
    const inputs = useRef(null)
    const [data, setData] = useState("")
    const [loading, setLoading] = useState("")
    console.log(data)

    function UrlHandler() {
        setLoading("load")
        if (inputs.current) {

            axios.get('http://localhost:8000/OSINT/?url=' + inputs.current.value)
                .then(res => {
                    setData(res);
                    setLoading("noload")
                })

        }

    }

    return (
        <div>
            <form>
                <input className={"input"} type={"search"} ref={inputs} placeholder={"Введите ваш url для OSINT"}/>
                <a className={"submit--btn"} value={">"} onClick={UrlHandler}>></a>
            </form>

            {loading == "load" ? <div className={"load"}>
                <img src={load} />
                <p>Это может занять несколько минут...</p>
            </div>: null}

            {data.data ? <div className={"osint_block"}>
                <h3 className={"osint_subtitle"}>XSS:</h3>
                {data.data.xss == 1 ? <p className={"osint_reject"}>Процент уязвимости: 100% (ПЛОХО).....</p> :
                    <p className={"osint_sucess"}>Процент уязвимости: 0% (ХОРОШО).....</p>
                }

                <h3 className={"osint_subtitle"}>CSRF:</h3>
                {data.data.csrf == 1 ? <p className={"osint_reject"}>Процент уязвимости: 100% (ПЛОХО).....</p> :
                    <p className={"osint_sucess"}>Процент уязвимости: 0% (ХОРОШО).....</p>
                }

                <h3 className={"osint_subtitle"}>Clickjacking:</h3>
                {data.data.clickjacking == 1 ? <p className={"osint_reject"}>Процент уязвимости: 100% (ПЛОХО).....</p> :
                    <p className={"osint_sucess"}>Процент уязвимости: 0% (ХОРОШО).....</p>
                }

                <h3 className={"osint_subtitle"}>SQL injection:</h3>
                {data.data.sql_injection == 1 ?
                    <p className={"osint_reject"}>Процент уязвимости: 100% (ПЛОХО).....</p> :
                    <p className={"osint_sucess"}>Процент уязвимости: 0% (ХОРОШО).....</p>
                }

                <h3 className={"osint_subtitle"}>Открытые порты:</h3>
                {data.data.open_ports ?
                    <p className={"osint_info_text"}>На этом сайте разработчики забыли закрыть доступ к данным
                        портам:</p> :
                    <p className={"osint_info_text"}>На этом сайте разработчики не забыли закрыть доступ к портам</p>}


                {data.data.open_ports ?
                    data.data.open_ports.map((e) => {
                        return (
                            <div>
                                <div className="code-block"><code>{JSON.stringify(e.text)}</code></div>
                            </div>
                        )
                    })
                    : null}

                <h3 className={"osint_subtitle"}>Info:</h3>
                {data.data.info ?
                    <p className={"osint_info_text"}>На этом сайте разработчики забыли закрыть доступ к данным
                        файлом:</p> :
                    <p className={"osint_info_text"}>На этом сайте разработчики не забыли закрыть доступ к файлом для
                        разработки</p>}


                {data.data.info ?
                    data.data.info.map((e) => {
                        return (
                            <div>
                                <h3 className={"info_subtitle"}>{JSON.stringify(e.name)}:</h3>
                                <div className="code-block"><code>{JSON.stringify(e.text)}</code></div>
                            </div>
                        )
                    })
                    : null}


            </div> : <img src={icon1} style={{width: "75%", marginTop: "3%"}}/>}


        </div>
    );
};


export default OsintInput;